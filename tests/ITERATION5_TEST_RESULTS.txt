
> ai-orchestra@0.6.0 test
> c8 --reporter=text --reporter=html node --test tests/**/*.test.js

TAP version 13
# [test] Request failed (attempt 1/3), retrying in 10ms...
# Subtest: Base Connector Tests
    # Subtest: Abstract Class Enforcement
        # Subtest: should throw error when instantiated directly
        ok 1 - should throw error when instantiated directly
          ---
          duration_ms: 1.814072
          type: 'test'
          ...
        # Subtest: should allow instantiation through subclass
        ok 2 - should allow instantiation through subclass
          ---
          duration_ms: 0.386507
          type: 'test'
          ...
        # Subtest: should set provider from config
        ok 3 - should set provider from config
          ---
          duration_ms: 0.238402
          type: 'test'
          ...
        # Subtest: should use default provider if not specified
        ok 4 - should use default provider if not specified
          ---
          duration_ms: 0.135152
          type: 'test'
          ...
        1..4
    ok 1 - Abstract Class Enforcement
      ---
      duration_ms: 3.649861
      type: 'suite'
      ...
    # Subtest: Configuration Defaults
        # Subtest: should use default retry attempts
        ok 1 - should use default retry attempts
          ---
          duration_ms: 1.496616
          type: 'test'
          ...
        # Subtest: should use custom retry attempts
        ok 2 - should use custom retry attempts
          ---
          duration_ms: 0.184563
          type: 'test'
          ...
        # Subtest: should use default retry delay
        ok 3 - should use default retry delay
          ---
          duration_ms: 0.114175
          type: 'test'
          ...
        # Subtest: should use custom retry delay
        ok 4 - should use custom retry delay
          ---
          duration_ms: 0.122261
          type: 'test'
          ...
        # Subtest: should use default timeout
        ok 5 - should use default timeout
          ---
          duration_ms: 0.092521
          type: 'test'
          ...
        # Subtest: should use custom timeout
        ok 6 - should use custom timeout
          ---
          duration_ms: 0.100877
          type: 'test'
          ...
        1..6
    ok 2 - Configuration Defaults
      ---
      duration_ms: 2.404984
      type: 'suite'
      ...
    # Subtest: Retry Mechanism
        # Subtest: should succeed on first attempt
        ok 1 - should succeed on first attempt
          ---
          duration_ms: 1.138193
          type: 'test'
          ...
# [test] Request failed (attempt 2/3), retrying in 20ms...
# [test] Request failed (attempt 1/3), retrying in 10ms...
        # Subtest: should retry on failure and eventually succeed
        ok 2 - should retry on failure and eventually succeed
          ---
          duration_ms: 36.302263
          type: 'test'
          ...
# [test] Request failed (attempt 2/3), retrying in 20ms...
# [test] Request failed (attempt 1/4), retrying in 10ms...
        # Subtest: should throw error after max retries exhausted
        ok 3 - should throw error after max retries exhausted
          ---
          duration_ms: 31.913268
          type: 'test'
          ...
# [test] Request failed (attempt 2/4), retrying in 20ms...
# [test] Request failed (attempt 3/4), retrying in 40ms...
# [test] Request failed (attempt 1/2), retrying in 10ms...
        # Subtest: should use exponential backoff for delays
        ok 4 - should use exponential backoff for delays
          ---
          duration_ms: 72.632117
          type: 'test'
          ...
        # Subtest: should respect custom retry attempts
        ok 5 - should respect custom retry attempts
          ---
          duration_ms: 10.952948
          type: 'test'
          ...
        # Subtest: should pass through successful result immediately
        ok 6 - should pass through successful result immediately
          ---
          duration_ms: 0.458801
          type: 'test'
          ...
        1..6
    ok 3 - Retry Mechanism
      ---
      duration_ms: 153.893375
      type: 'suite'
      ...
    # Subtest: Sleep Utility
        # Subtest: should delay for specified milliseconds
        ok 1 - should delay for specified milliseconds
          ---
          duration_ms: 50.971451
          type: 'test'
          ...
# [test] Request failed (attempt 1/2), retrying in 10ms...
        # Subtest: should resolve immediately for 0ms
        ok 2 - should resolve immediately for 0ms
          ---
          duration_ms: 2.147635
          type: 'test'
          ...
        1..2
    ok 4 - Sleep Utility
      ---
      duration_ms: 53.438384
      type: 'suite'
      ...
    # Subtest: Response Standardization
        # Subtest: should standardize complete response
        ok 1 - should standardize complete response
          ---
          duration_ms: 1.912549
          type: 'test'
          ...
        # Subtest: should handle missing content
        ok 2 - should handle missing content
          ---
          duration_ms: 0.166065
          type: 'test'
          ...
        # Subtest: should handle missing model
        ok 3 - should handle missing model
          ---
          duration_ms: 0.142298
          type: 'test'
          ...
        # Subtest: should handle missing usage
        ok 4 - should handle missing usage
          ---
          duration_ms: 0.135826
          type: 'test'
          ...
        # Subtest: should handle missing metadata
        ok 5 - should handle missing metadata
          ---
          duration_ms: 0.121082
          type: 'test'
          ...
        # Subtest: should add timestamp to response
        ok 6 - should add timestamp to response
          ---
          duration_ms: 0.168855
          type: 'test'
          ...
        # Subtest: should preserve all original fields
        ok 7 - should preserve all original fields
          ---
          duration_ms: 0.128092
          type: 'test'
          ...
        1..7
    ok 5 - Response Standardization
      ---
      duration_ms: 3.098876
      type: 'suite'
      ...
    # Subtest: Error Handling
        # Subtest: should format basic error
        ok 1 - should format basic error
          ---
          duration_ms: 0.323363
          type: 'test'
          ...
        # Subtest: should include error code if present
        ok 2 - should include error code if present
          ---
          duration_ms: 0.173858
          type: 'test'
          ...
        # Subtest: should use UNKNOWN_ERROR as default code
        ok 3 - should use UNKNOWN_ERROR as default code
          ---
          duration_ms: 0.163242
          type: 'test'
          ...
        # Subtest: should include response status if present
        ok 4 - should include response status if present
          ---
          duration_ms: 0.183432
          type: 'test'
          ...
        # Subtest: should handle error without response
        ok 5 - should handle error without response
          ---
          duration_ms: 0.149175
          type: 'test'
          ...
        # Subtest: should preserve error message
        ok 6 - should preserve error message
          ---
          duration_ms: 0.147488
          type: 'test'
          ...
        1..6
    ok 6 - Error Handling
      ---
      duration_ms: 1.382246
      type: 'suite'
      ...
    # Subtest: Abstract Method Enforcement
        # Subtest: base query should throw not implemented
        ok 1 - base query should throw not implemented
          ---
          duration_ms: 0.461671
          type: 'test'
          ...
        # Subtest: base streamQuery should throw not implemented
        ok 2 - base streamQuery should throw not implemented
          ---
          duration_ms: 0.46135
          type: 'test'
          ...
        # Subtest: base validateConfig should throw not implemented
        ok 3 - base validateConfig should throw not implemented
          ---
          duration_ms: 0.260269
          type: 'test'
          ...
        # Subtest: base testConnection should throw not implemented
        ok 4 - base testConnection should throw not implemented
          ---
          duration_ms: 0.270137
          type: 'test'
          ...
        # Subtest: base getModels should throw not implemented
        ok 5 - base getModels should throw not implemented
          ---
          duration_ms: 0.1981
          type: 'test'
          ...
        1..5
    ok 7 - Abstract Method Enforcement
      ---
      duration_ms: 1.911092
      type: 'suite'
      ...
    # Subtest: Integration with Subclass
        # Subtest: subclass should call inherited withRetry
        ok 1 - subclass should call inherited withRetry
          ---
          duration_ms: 20.097436
          type: 'test'
          ...
        # Subtest: subclass should use standardizeResponse
        ok 2 - subclass should use standardizeResponse
          ---
          duration_ms: 0.309489
          type: 'test'
          ...
        1..2
    ok 8 - Integration with Subclass
      ---
      duration_ms: 20.575116
      type: 'suite'
      ...
    1..8
ok 1 - Base Connector Tests
  ---
  duration_ms: 241.285786
  type: 'suite'
  ...
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[31merror[39m]: [LLMBridge] Failed to initialize OpenAI connector {"service":"ai-orchestra","error":"OpenAI API key is required"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# Subtest: P0/P2 Bug Fixes Validation - Iteration 3
    # Subtest: Bug \#11 Residual (P0): LLMBridge Null Provider Config
        # Subtest: LLMBridge should handle null provider config without TypeError
        ok 1 - LLMBridge should handle null provider config without TypeError
          ---
          duration_ms: 6.099904
          type: 'test'
          ...
        # Subtest: LLMBridge should handle undefined provider config
        ok 2 - LLMBridge should handle undefined provider config
          ---
          duration_ms: 0.53473
          type: 'test'
          ...
        # Subtest: LLMBridge should handle empty provider config
        ok 3 - LLMBridge should handle empty provider config
          ---
          duration_ms: 0.415367
          type: 'test'
          ...
        # Subtest: LLMBridge should handle config without providers key
        ok 4 - LLMBridge should handle config without providers key
          ---
          duration_ms: 0.32986
          type: 'test'
          ...
        # Subtest: LLMBridge should handle null openai provider config
        ok 5 - LLMBridge should handle null openai provider config
          ---
          duration_ms: 0.311377
          type: 'test'
          ...
        # Subtest: LLMBridge should handle provider with null enabled flag
        ok 6 - LLMBridge should handle provider with null enabled flag
          ---
          duration_ms: 0.286205
          type: 'test'
          ...
        # Subtest: LLMBridge should handle provider with undefined enabled flag
        ok 7 - LLMBridge should handle provider with undefined enabled flag
          ---
          duration_ms: 0.308811
          type: 'test'
          ...
        # Subtest: LLMBridge should handle provider with missing enabled flag
        ok 8 - LLMBridge should handle provider with missing enabled flag
          ---
          duration_ms: 0.301373
          type: 'test'
          ...
        # Subtest: LLMBridge should provide clear error message when querying with no connectors
        ok 9 - LLMBridge should provide clear error message when querying with no connectors
          ---
          duration_ms: 1.31219
          type: 'test'
          ...
        # Subtest: LLMBridge should handle null config in query method
        ok 10 - LLMBridge should handle null config in query method
          ---
          duration_ms: 0.490813
          type: 'test'
          ...
        # Subtest: LLMBridge should handle missing provider parameter in query
        ok 11 - LLMBridge should handle missing provider parameter in query
          ---
          duration_ms: 0.409177
          type: 'test'
          ...
        # Subtest: LLMBridge selectProvider should handle no available providers
        ok 12 - LLMBridge selectProvider should handle no available providers
          ---
          duration_ms: 0.365049
          type: 'test'
          ...
        # Subtest: LLMBridge should handle mixed null and valid providers
        ok 13 - LLMBridge should handle mixed null and valid providers
          ---
          duration_ms: 0.558635
          type: 'test'
          ...
        # Subtest: LLMBridge should continue functioning with one valid provider despite null others
        ok 14 - LLMBridge should continue functioning with one valid provider despite null others
          ---
          duration_ms: 1.30693
          type: 'test'
          ...
        # Subtest: LLMBridge should handle deeply nested null config
        ok 15 - LLMBridge should handle deeply nested null config
          ---
          duration_ms: 0.936727
          type: 'test'
          ...
        1..15
    ok 1 - Bug \#11 Residual (P0): LLMBridge Null Provider Config
      ---
      duration_ms: 15.314752
      type: 'suite'
      ...
    # Subtest: Bug \#9 (P2): Winston Logger Usage
        # Subtest: LLMBridge should use logger instead of console.log
        ok 1 - LLMBridge should use logger instead of console.log
          ---
          duration_ms: 0.528939
          type: 'test'
          ...
        # Subtest: Server should use winston for logging
        ok 2 - Server should use winston for logging
          ---
          duration_ms: 0.489913
          type: 'test'
          ...
        # Subtest: Connectors should use winston for logging
        ok 3 - Connectors should use winston for logging
          ---
          duration_ms: 1.481689
          type: 'test'
          ...
        # Subtest: Logger should have proper log levels
        ok 4 - Logger should have proper log levels
          ---
          duration_ms: 0.146368
          type: 'test'
          ...
        # Subtest: Logger should format logs consistently
        ok 5 - Logger should format logs consistently
          ---
          duration_ms: 0.121898
          type: 'test'
          ...
        1..5
    ok 2 - Bug \#9 (P2): Winston Logger Usage
      ---
      duration_ms: 3.134355
      type: 'suite'
      ...
    # Subtest: Bug \#10 (P2): Input Validation on Endpoints
        # Subtest: Query endpoint should validate prompt field
        ok 1 - Query endpoint should validate prompt field
          ---
          duration_ms: 0.67415
          type: 'test'
          ...
        # Subtest: Query endpoint should validate temperature range
        ok 2 - Query endpoint should validate temperature range
          ---
          duration_ms: 0.157995
          type: 'test'
          ...
        # Subtest: Query endpoint should validate maxTokens
        ok 3 - Query endpoint should validate maxTokens
          ---
          duration_ms: 0.110521
          type: 'test'
          ...
        # Subtest: Query endpoint should validate prompt length
        ok 4 - Query endpoint should validate prompt length
          ---
          duration_ms: 0.097601
          type: 'test'
          ...
        # Subtest: Query endpoint should validate provider parameter
        ok 5 - Query endpoint should validate provider parameter
          ---
          duration_ms: 0.089884
          type: 'test'
          ...
        # Subtest: Query endpoint should validate model parameter format
        ok 6 - Query endpoint should validate model parameter format
          ---
          duration_ms: 0.090923
          type: 'test'
          ...
        # Subtest: Stream endpoint should have similar validation as query
        ok 7 - Stream endpoint should have similar validation as query
          ---
          duration_ms: 0.10056
          type: 'test'
          ...
        # Subtest: Validation errors should return consistent format
        ok 8 - Validation errors should return consistent format
          ---
          duration_ms: 0.137644
          type: 'test'
          ...
        # Subtest: Validation should sanitize input to prevent injection
        ok 9 - Validation should sanitize input to prevent injection
          ---
          duration_ms: 0.115697
          type: 'test'
          ...
        # Subtest: Validation should handle edge cases
        ok 10 - Validation should handle edge cases
          ---
          duration_ms: 0.107844
          type: 'test'
          ...
        1..10
    ok 3 - Bug \#10 (P2): Input Validation on Endpoints
      ---
      duration_ms: 2.061431
      type: 'suite'
      ...
    # Subtest: Bug \#13 (P2): Event-Based Waiting Instead of Polling
        # Subtest: Python orchestrator should use event-based waiting
        ok 1 - Python orchestrator should use event-based waiting
          ---
          duration_ms: 0.72802
          type: 'test'
          ...
        # Subtest: Event-based waiting should be more efficient than polling
        ok 2 - Event-based waiting should be more efficient than polling
          ---
          duration_ms: 0.173057
          type: 'test'
          ...
        # Subtest: Event-based waiting should handle timeouts
        ok 3 - Event-based waiting should handle timeouts
          ---
          duration_ms: 0.140732
          type: 'test'
          ...
        # Subtest: Event-based waiting should be thread-safe
        ok 4 - Event-based waiting should be thread-safe
          ---
          duration_ms: 0.127433
          type: 'test'
          ...
        # Subtest: Event-based waiting should handle multiple waiters
        ok 5 - Event-based waiting should handle multiple waiters
          ---
          duration_ms: 0.109174
          type: 'test'
          ...
        1..5
    ok 4 - Bug \#13 (P2): Event-Based Waiting Instead of Polling
      ---
      duration_ms: 1.523524
      type: 'suite'
      ...
    # Subtest: Regression Tests - Ensure No Regressions from Iterations 1 & 2
        # Subtest: ConfigManager still handles null configs after Bug \#11 fix
        ok 1 - ConfigManager still handles null configs after Bug \#11 fix
          ---
          duration_ms: 1.908621
          type: 'test'
          ...
        # Subtest: LLMBridge initialization does not throw after fixes
        ok 2 - LLMBridge initialization does not throw after fixes
          ---
          duration_ms: 0.464188
          type: 'test'
          ...
        # Subtest: All previous P1 bug fixes still work
        ok 3 - All previous P1 bug fixes still work
          ---
          duration_ms: 0.144723
          type: 'test'
          ...
        # Subtest: Coverage should not decrease after new changes
        ok 4 - Coverage should not decrease after new changes
          ---
          duration_ms: 0.124453
          type: 'test'
          ...
        # Subtest: All 340 existing tests should still pass
        ok 5 - All 340 existing tests should still pass
          ---
          duration_ms: 0.111467
          type: 'test'
          ...
        1..5
    ok 5 - Regression Tests - Ensure No Regressions from Iterations 1 & 2
      ---
      duration_ms: 3.016989
      type: 'suite'
      ...
    # Subtest: Defense in Depth - Additional Safety Tests
        # Subtest: LLMBridge should handle array instead of object config
        ok 1 - LLMBridge should handle array instead of object config
          ---
          duration_ms: 0.456918
          type: 'test'
          ...
        # Subtest: LLMBridge should handle string instead of object config
        ok 2 - LLMBridge should handle string instead of object config
          ---
          duration_ms: 0.324473
          type: 'test'
          ...
        # Subtest: LLMBridge should handle number instead of object config
        ok 3 - LLMBridge should handle number instead of object config
          ---
          duration_ms: 0.338878
          type: 'test'
          ...
        # Subtest: LLMBridge should handle boolean instead of object config
        ok 4 - LLMBridge should handle boolean instead of object config
          ---
          duration_ms: 0.342212
          type: 'test'
          ...
        # Subtest: LLMBridge should handle circular reference in config
        ok 5 - LLMBridge should handle circular reference in config
          ---
          duration_ms: 0.352515
          type: 'test'
          ...
        1..5
    ok 6 - Defense in Depth - Additional Safety Tests
      ---
      duration_ms: 2.054769
      type: 'suite'
      ...
    1..6
ok 2 - P0/P2 Bug Fixes Validation - Iteration 3
  ---
  duration_ms: 28.242305
  type: 'suite'
  ...
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# Subtest: P1 Bug Fixes Validation
    # Subtest: Bug \#11: Config Null Checks
        # Subtest: ConfigManager should handle missing config file gracefully
        ok 1 - ConfigManager should handle missing config file gracefully
          ---
          duration_ms: 3.43444
          type: 'test'
          ...
        # Subtest: ConfigManager should provide default values for missing fields
        ok 2 - ConfigManager should provide default values for missing fields
          ---
          duration_ms: 0.915884
          type: 'test'
          ...
        # Subtest: ConfigManager should handle null application config
        ok 3 - ConfigManager should handle null application config
          ---
          duration_ms: 0.674684
          type: 'test'
          ...
        # Subtest: ConfigManager should handle null provider config
        ok 4 - ConfigManager should handle null provider config
          ---
          duration_ms: 0.515642
          type: 'test'
          ...
        # Subtest: ConfigManager should handle missing nested fields
        ok 5 - ConfigManager should handle missing nested fields
          ---
          duration_ms: 0.610328
          type: 'test'
          ...
        # Subtest: ConfigManager should handle undefined security config
        ok 6 - ConfigManager should handle undefined security config
          ---
          duration_ms: 0.594405
          type: 'test'
          ...
        # Subtest: ConfigManager should handle null CORS config
        ok 7 - ConfigManager should handle null CORS config
          ---
          duration_ms: 0.478394
          type: 'test'
          ...
        # Subtest: ConfigManager should handle null rate limiting config
        ok 8 - ConfigManager should handle null rate limiting config
          ---
          duration_ms: 0.473546
          type: 'test'
          ...
        # Subtest: ConfigManager should handle null WebSocket config
        ok 9 - ConfigManager should handle null WebSocket config
          ---
          duration_ms: 0.42518
          type: 'test'
          ...
        # Subtest: ConfigManager should handle null logging config
        ok 10 - ConfigManager should handle null logging config
          ---
          duration_ms: 0.616581
          type: 'test'
          ...
        # Subtest: ConfigManager.validate should handle null config
        ok 11 - ConfigManager.validate should handle null config
          ---
          duration_ms: 0.912729
          type: 'test'
          ...
        # Subtest: ConfigManager should not throw TypeError on null access
        ok 12 - ConfigManager should not throw TypeError on null access
          ---
          duration_ms: 0.791808
          type: 'test'
          ...
        # Subtest: LLMBridge should handle null provider config
        ok 13 - LLMBridge should handle null provider config
          ---
          duration_ms: 5.205037
          type: 'test'
          ...
        # Subtest: LLMBridge should handle undefined provider config
        ok 14 - LLMBridge should handle undefined provider config
          ---
          duration_ms: 0.42677
          type: 'test'
          ...
        # Subtest: LLMBridge should handle empty provider config
        ok 15 - LLMBridge should handle empty provider config
          ---
          duration_ms: 0.616833
          type: 'test'
          ...
        # Subtest: LLMBridge should handle null defaultProvider
        ok 16 - LLMBridge should handle null defaultProvider
          ---
          duration_ms: 0.445837
          type: 'test'
          ...
        # Subtest: LLMBridge should handle null loadBalancing
        ok 17 - LLMBridge should handle null loadBalancing
          ---
          duration_ms: 0.393026
          type: 'test'
          ...
        # Subtest: LLMBridge should provide fallback defaults
        ok 18 - LLMBridge should provide fallback defaults
          ---
          duration_ms: 0.390866
          type: 'test'
          ...
        1..18
    ok 1 - Bug \#11: Config Null Checks
      ---
      duration_ms: 19.816923
      type: 'suite'
      ...
    # Subtest: Bug \#6: EventSource Security (Validation)
        # Subtest: should document that POST should be used for streaming
        ok 1 - should document that POST should be used for streaming
          ---
          duration_ms: 0.205477
          type: 'test'
          ...
        # Subtest: should validate that sensitive data is not in URL query params
        ok 2 - should validate that sensitive data is not in URL query params
          ---
          duration_ms: 0.178363
          type: 'test'
          ...
        # Subtest: should validate request body contains stream parameters
        ok 3 - should validate request body contains stream parameters
          ---
          duration_ms: 0.132408
          type: 'test'
          ...
        # Subtest: should validate EventSource can work with POST via proxy
        ok 4 - should validate EventSource can work with POST via proxy
          ---
          duration_ms: 0.097313
          type: 'test'
          ...
        1..4
    ok 2 - Bug \#6: EventSource Security (Validation)
      ---
      duration_ms: 0.834717
      type: 'suite'
      ...
    # Subtest: Bug \#7: CSRF Protection (Validation)
        # Subtest: should validate CSRF token structure
        ok 1 - should validate CSRF token structure
          ---
          duration_ms: 0.523681
          type: 'test'
          ...
        # Subtest: should validate that CSRF tokens are required for POST requests
        ok 2 - should validate that CSRF tokens are required for POST requests
          ---
          duration_ms: 0.189721
          type: 'test'
          ...
        # Subtest: should validate SameSite cookie configuration
        ok 3 - should validate SameSite cookie configuration
          ---
          duration_ms: 0.188338
          type: 'test'
          ...
        # Subtest: should validate origin checking for CORS
        ok 4 - should validate origin checking for CORS
          ---
          duration_ms: 0.11439
          type: 'test'
          ...
        # Subtest: should reject requests without valid CSRF token
        ok 5 - should reject requests without valid CSRF token
          ---
          duration_ms: 0.123577
          type: 'test'
          ...
        # Subtest: should validate CSRF token expiration
        ok 6 - should validate CSRF token expiration
          ---
          duration_ms: 0.16377
          type: 'test'
          ...
        # Subtest: should validate secure cookie settings in production
        ok 7 - should validate secure cookie settings in production
          ---
          duration_ms: 0.132517
          type: 'test'
          ...
        1..7
    ok 3 - Bug \#7: CSRF Protection (Validation)
      ---
      duration_ms: 1.739753
      type: 'suite'
      ...
    # Subtest: Bug \#6 & \#7: Integration Security Tests
        # Subtest: should validate that streaming endpoint uses secure methods
        ok 1 - should validate that streaming endpoint uses secure methods
          ---
          duration_ms: 0.26969
          type: 'test'
          ...
        # Subtest: should validate query endpoint security
        ok 2 - should validate query endpoint security
          ---
          duration_ms: 0.136948
          type: 'test'
          ...
        # Subtest: should validate that GET endpoints do not accept sensitive data
        ok 3 - should validate that GET endpoints do not accept sensitive data
          ---
          duration_ms: 0.149333
          type: 'test'
          ...
        1..3
    ok 4 - Bug \#6 & \#7: Integration Security Tests
      ---
      duration_ms: 0.741859
      type: 'suite'
      ...
    # Subtest: Regression Tests
        # Subtest: should not allow null pointer exceptions in config access
        ok 1 - should not allow null pointer exceptions in config access
          ---
          duration_ms: 1.068059
          type: 'test'
          ...
        # Subtest: should maintain backward compatibility with valid configs
        ok 2 - should maintain backward compatibility with valid configs
          ---
          duration_ms: 0.559922
          type: 'test'
          ...
        # Subtest: should handle edge cases without crashing
        ok 3 - should handle edge cases without crashing
          ---
          duration_ms: 0.90407
          type: 'test'
          ...
        # Subtest: should not leak sensitive data in error messages
        ok 4 - should not leak sensitive data in error messages
          ---
          duration_ms: 0.242541
          type: 'test'
          ...
        # Subtest: should validate that all critical paths have null checks
        ok 5 - should validate that all critical paths have null checks
          ---
          duration_ms: 0.557403
          type: 'test'
          ...
        # Subtest: should handle concurrent null config access
        ok 6 - should handle concurrent null config access
          ---
          duration_ms: 3.805702
          type: 'test'
          ...
        1..6
    ok 5 - Regression Tests
      ---
      duration_ms: 7.489243
      type: 'suite'
      ...
    # Subtest: Defense in Depth
        # Subtest: should implement multiple layers of security
        ok 1 - should implement multiple layers of security
          ---
          duration_ms: 0.210785
          type: 'test'
          ...
        # Subtest: should fail securely on errors
        ok 2 - should fail securely on errors
          ---
          duration_ms: 0.206344
          type: 'test'
          ...
        # Subtest: should validate all user input
        ok 3 - should validate all user input
          ---
          duration_ms: 0.155398
          type: 'test'
          ...
        # Subtest: should implement proper error boundaries
        ok 4 - should implement proper error boundaries
          ---
          duration_ms: 0.220868
          type: 'test'
          ...
        1..4
    ok 6 - Defense in Depth
      ---
      duration_ms: 1.005713
      type: 'suite'
      ...
    1..6
ok 3 - P1 Bug Fixes Validation
  ---
  duration_ms: 32.483557
  type: 'suite'
  ...
# Subtest: Bug Fix Validation (P0)
    # Subtest: Bug \#1: Memory Leak Fix (CRITICAL)
        # Subtest: should have cleanup mechanism for activeRuns Map
        ok 1 - should have cleanup mechanism for activeRuns Map
          ---
          duration_ms: 1.166527
          type: 'test'
          ...
        # Subtest: should track timestamp for each run
        ok 2 - should track timestamp for each run
          ---
          duration_ms: 0.238376
          type: 'test'
          ...
        # Subtest: should delete runs older than MAX_RUN_AGE
        ok 3 - should delete runs older than MAX_RUN_AGE
          ---
          duration_ms: 0.145791
          type: 'test'
          ...
        # Subtest: should limit total runs to MAX_RUNS
        ok 4 - should limit total runs to MAX_RUNS
          ---
          duration_ms: 0.328265
          type: 'test'
          ...
        # Subtest: should run cleanup interval periodically
        ok 5 - should run cleanup interval periodically
          ---
          duration_ms: 0.15854
          type: 'test'
          ...
        # Subtest: should log cleanup operations
        ok 6 - should log cleanup operations
          ---
          duration_ms: 0.132545
          type: 'test'
          ...
        # Subtest: should prevent unbounded memory growth
        ok 7 - should prevent unbounded memory growth
          ---
          duration_ms: 1.663759
          type: 'test'
          ...
        # Subtest: should enable horizontal scaling (future)
        ok 8 - should enable horizontal scaling (future)
          ---
          duration_ms: 0.133349
          type: 'test'
          ...
        1..8
    ok 1 - Bug \#1: Memory Leak Fix (CRITICAL)
      ---
      duration_ms: 5.08489
      type: 'suite'
      ...
    # Subtest: Bug \#2: WebSocket Infinite Loop Fix (CRITICAL)
        # Subtest: should use useRef instead of useState for reconnectAttempts
        ok 1 - should use useRef instead of useState for reconnectAttempts
          ---
          duration_ms: 0.234515
          type: 'test'
          ...
        # Subtest: should not include reconnectAttempts in useCallback dependency array
        ok 2 - should not include reconnectAttempts in useCallback dependency array
          ---
          duration_ms: 0.108576
          type: 'test'
          ...
        # Subtest: should increment reconnectAttemptsRef without triggering re-render
        ok 3 - should increment reconnectAttemptsRef without triggering re-render
          ---
          duration_ms: 0.102772
          type: 'test'
          ...
        # Subtest: should reset reconnectAttemptsRef on successful connection
        ok 4 - should reset reconnectAttemptsRef on successful connection
          ---
          duration_ms: 0.095092
          type: 'test'
          ...
        # Subtest: should respect maxReconnectAttempts limit
        ok 5 - should respect maxReconnectAttempts limit
          ---
          duration_ms: 0.099694
          type: 'test'
          ...
        # Subtest: should eliminate infinite loop
        ok 6 - should eliminate infinite loop
          ---
          duration_ms: 0.083807
          type: 'test'
          ...
        # Subtest: should prevent 100% CPU usage on client
        ok 7 - should prevent 100% CPU usage on client
          ---
          duration_ms: 0.077262
          type: 'test'
          ...
        # Subtest: should stabilize WebSocket connections
        ok 8 - should stabilize WebSocket connections
          ---
          duration_ms: 0.096978
          type: 'test'
          ...
        1..8
    ok 2 - Bug \#2: WebSocket Infinite Loop Fix (CRITICAL)
      ---
      duration_ms: 1.266286
      type: 'suite'
      ...
    # Subtest: Bug \#3: Rate Limiting Fix (HIGH)
        # Subtest: should use correct config property rateLimiting
        ok 1 - should use correct config property rateLimiting
          ---
          duration_ms: 0.180929
          type: 'test'
          ...
        # Subtest: should not check for rateLimit property (old bug)
        ok 2 - should not check for rateLimit property (old bug)
          ---
          duration_ms: 0.102721
          type: 'test'
          ...
        # Subtest: should enable DoS protection
        ok 3 - should enable DoS protection
          ---
          duration_ms: 0.086369
          type: 'test'
          ...
        # Subtest: should use default rate limit values
        ok 4 - should use default rate limit values
          ---
          duration_ms: 0.102086
          type: 'test'
          ...
        # Subtest: should return 429 when rate limit exceeded
        ok 5 - should return 429 when rate limit exceeded
          ---
          duration_ms: 0.091622
          type: 'test'
          ...
        # Subtest: should log rate limiting activation
        ok 6 - should log rate limiting activation
          ---
          duration_ms: 0.083233
          type: 'test'
          ...
        # Subtest: should prevent API abuse
        ok 7 - should prevent API abuse
          ---
          duration_ms: 0.086621
          type: 'test'
          ...
        1..7
    ok 3 - Bug \#3: Rate Limiting Fix (HIGH)
      ---
      duration_ms: 0.975192
      type: 'suite'
      ...
    # Subtest: Bug \#4: Deprecated API Fix (HIGH)
        # Subtest: should use substring instead of substr
        ok 1 - should use substring instead of substr
          ---
          duration_ms: 0.453476
          type: 'test'
          ...
        # Subtest: should generate valid run IDs with substring
        ok 2 - should generate valid run IDs with substring
          ---
          duration_ms: 0.173139
          type: 'test'
          ...
        # Subtest: should not use deprecated substr method
        ok 3 - should not use deprecated substr method
          ---
          duration_ms: 0.108746
          type: 'test'
          ...
        # Subtest: should be compatible with future Node.js versions
        ok 4 - should be compatible with future Node.js versions
          ---
          duration_ms: 0.11306
          type: 'test'
          ...
        # Subtest: should handle substring edge cases
        ok 5 - should handle substring edge cases
          ---
          duration_ms: 0.099531
          type: 'test'
          ...
        # Subtest: should not trigger deprecation warnings
        ok 6 - should not trigger deprecation warnings
          ---
          duration_ms: 0.087097
          type: 'test'
          ...
        1..6
    ok 4 - Bug \#4: Deprecated API Fix (HIGH)
      ---
      duration_ms: 1.305789
      type: 'suite'
      ...
    # Subtest: Overall Bug Fix Impact
        # Subtest: should improve production readiness from 65% to 75%
        ok 1 - should improve production readiness from 65% to 75%
          ---
          duration_ms: 0.330356
          type: 'test'
          ...
        # Subtest: should fix all CRITICAL bugs
        ok 2 - should fix all CRITICAL bugs
          ---
          duration_ms: 0.206169
          type: 'test'
          ...
        # Subtest: should fix all HIGH priority bugs
        ok 3 - should fix all HIGH priority bugs
          ---
          duration_ms: 0.167934
          type: 'test'
          ...
        # Subtest: should enable long-running production deployments
        ok 4 - should enable long-running production deployments
          ---
          duration_ms: 0.172396
          type: 'test'
          ...
        # Subtest: should stabilize client connections
        ok 5 - should stabilize client connections
          ---
          duration_ms: 0.157357
          type: 'test'
          ...
        # Subtest: should protect against DoS attacks
        ok 6 - should protect against DoS attacks
          ---
          duration_ms: 0.153395
          type: 'test'
          ...
        # Subtest: should ensure future compatibility
        ok 7 - should ensure future compatibility
          ---
          duration_ms: 0.230529
          type: 'test'
          ...
        1..7
    ok 5 - Overall Bug Fix Impact
      ---
      duration_ms: 5.376598
      type: 'suite'
      ...
    1..5
ok 4 - Bug Fix Validation (P0)
  ---
  duration_ms: 14.800287
  type: 'suite'
  ...
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Ollama connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# Subtest: LLM Bridge Advanced Tests
    # Subtest: getConnector() method
        # Subtest: should return specific connector
        ok 1 - should return specific connector
          ---
          duration_ms: 7.270001
          type: 'test'
          ...
        # Subtest: should return undefined for non-existent provider
        ok 2 - should return undefined for non-existent provider
          ---
          duration_ms: 0.591892
          type: 'test'
          ...
        # Subtest: should return undefined when no connectors initialized
        ok 3 - should return undefined when no connectors initialized
          ---
          duration_ms: 0.470738
          type: 'test'
          ...
        # Subtest: should handle null provider name
        ok 4 - should handle null provider name
          ---
          duration_ms: 0.536947
          type: 'test'
          ...
        # Subtest: should handle undefined provider name
        ok 5 - should handle undefined provider name
          ---
          duration_ms: 0.651313
          type: 'test'
          ...
        1..5
    ok 1 - getConnector() method
      ---
      duration_ms: 10.621385
      type: 'suite'
      ...
    # Subtest: getAvailableProviders() method
        # Subtest: should return list of available providers
        ok 1 - should return list of available providers
          ---
          duration_ms: 0.539836
          type: 'test'
          ...
        # Subtest: should return empty array when no providers
        ok 2 - should return empty array when no providers
          ---
          duration_ms: 0.287476
          type: 'test'
          ...
        # Subtest: should return multiple providers
        ok 3 - should return multiple providers
          ---
          duration_ms: 0.906485
          type: 'test'
          ...
        # Subtest: should not include disabled providers
        ok 4 - should not include disabled providers
          ---
          duration_ms: 0.667743
          type: 'test'
          ...
        1..4
    ok 2 - getAvailableProviders() method
      ---
      duration_ms: 2.625302
      type: 'suite'
      ...
# [Grok] Connection test failed: Request failed with status code 403
# 2025-11-13 14:54:56 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
    # Subtest: testAllConnections() method
        # Subtest: should return results object
        ok 1 - should return results object
          ---
          duration_ms: 72.003245
          type: 'test'
          ...
# [Grok] Connection test failed: Request failed with status code 403
# 2025-11-13 14:54:56 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Ollama connector initialized {"service":"ai-orchestra"}
        # Subtest: should include connection status for each provider
        ok 2 - should include connection status for each provider
          ---
          duration_ms: 9.749684
          type: 'test'
          ...
        # Subtest: should return empty object for no providers
        ok 3 - should return empty object for no providers
          ---
          duration_ms: 1.456813
          type: 'test'
          ...
# [Grok] Connection test failed: Request failed with status code 403
# [Ollama] Connection test failed: fetch failed
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
        # Subtest: should test multiple providers
        ok 4 - should test multiple providers
          ---
          duration_ms: 21.32656
          type: 'test'
          ...
# [Grok] Connection test failed: Request failed with status code 403
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
        # Subtest: should handle connector that throws during test
        ok 5 - should handle connector that throws during test
          ---
          duration_ms: 10.213823
          type: 'test'
          ...
        1..5
    ok 3 - testAllConnections() method
      ---
      duration_ms: 115.254335
      type: 'suite'
      ...
# [Grok] Failed to get models: Request failed with status code 403
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
    # Subtest: getAllModels() method
        # Subtest: should return models object
        ok 1 - should return models object
          ---
          duration_ms: 5.299618
          type: 'test'
          ...
# [Grok] Failed to get models: Request failed with status code 403
# 2025-11-13 14:54:57 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Ollama connector initialized {"service":"ai-orchestra"}
        # Subtest: should return empty arrays for failed providers
        ok 2 - should return empty arrays for failed providers
          ---
          duration_ms: 4.23726
          type: 'test'
          ...
        # Subtest: should return empty object for no providers
        ok 3 - should return empty object for no providers
          ---
          duration_ms: 0.491706
          type: 'test'
          ...
# [Grok] Failed to get models: Request failed with status code 403
# [Ollama] Failed to get models: fetch failed
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Ollama connector initialized {"service":"ai-orchestra"}
        # Subtest: should get models from multiple providers
        ok 4 - should get models from multiple providers
          ---
          duration_ms: 5.227767
          type: 'test'
          ...
# [Grok] Failed to get models: Request failed with status code 403
# [Ollama] Failed to get models: fetch failed
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Ollama connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Ollama connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Ollama connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Ollama connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[31merror[39m]: [LLMBridge] Failed to initialize Grok connector {"service":"ai-orchestra","error":"Grok API key is required"}
# 2025-11-13 14:54:57 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:54:57 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
        # Subtest: should continue if one provider fails
        ok 5 - should continue if one provider fails
          ---
          duration_ms: 5.067374
          type: 'test'
          ...
        1..5
    ok 4 - getAllModels() method
      ---
      duration_ms: 20.744755
      type: 'suite'
      ...
    # Subtest: getStats() method
        # Subtest: should return stats object with correct structure
        ok 1 - should return stats object with correct structure
          ---
          duration_ms: 0.736655
          type: 'test'
          ...
        # Subtest: should show correct connector count
        ok 2 - should show correct connector count
          ---
          duration_ms: 0.577364
          type: 'test'
          ...
        # Subtest: should show zero connectors when none initialized
        ok 3 - should show zero connectors when none initialized
          ---
          duration_ms: 0.345741
          type: 'test'
          ...
        # Subtest: should include provider names
        ok 4 - should include provider names
          ---
          duration_ms: 0.392424
          type: 'test'
          ...
        # Subtest: should include load balancing strategy
        ok 5 - should include load balancing strategy
          ---
          duration_ms: 0.436935
          type: 'test'
          ...
        # Subtest: should include default provider
        ok 6 - should include default provider
          ---
          duration_ms: 0.402908
          type: 'test'
          ...
        # Subtest: should include fallback setting in config
        ok 7 - should include fallback setting in config
          ---
          duration_ms: 0.414784
          type: 'test'
          ...
        1..7
    ok 5 - getStats() method
      ---
      duration_ms: 3.621582
      type: 'suite'
      ...
    # Subtest: Load Balancing
        # Subtest: should use round-robin strategy
        ok 1 - should use round-robin strategy
          ---
          duration_ms: 0.77083
          type: 'test'
          ...
        # Subtest: should use random strategy
        ok 2 - should use random strategy
          ---
          duration_ms: 0.621321
          type: 'test'
          ...
        # Subtest: should use default strategy
        ok 3 - should use default strategy
          ---
          duration_ms: 0.570152
          type: 'test'
          ...
        # Subtest: should return single provider when only one available
        ok 4 - should return single provider when only one available
          ---
          duration_ms: 0.377427
          type: 'test'
          ...
        1..4
    ok 6 - Load Balancing
      ---
      duration_ms: 2.531803
      type: 'suite'
      ...
    # Subtest: Configuration Edge Cases
        # Subtest: should handle empty providers object
        ok 1 - should handle empty providers object
          ---
          duration_ms: 0.56775
          type: 'test'
          ...
        # Subtest: should handle null providers
        ok 2 - should handle null providers
          ---
          duration_ms: 0.317608
          type: 'test'
          ...
        # Subtest: should handle undefined providers
        ok 3 - should handle undefined providers
          ---
          duration_ms: 0.330348
          type: 'test'
          ...
        # Subtest: should handle providers without enabled flag
        ok 4 - should handle providers without enabled flag
          ---
          duration_ms: 0.320409
          type: 'test'
          ...
        # Subtest: should handle invalid load balancing strategy
        ok 5 - should handle invalid load balancing strategy
          ---
          duration_ms: 0.47995
          type: 'test'
          ...
        # Subtest: should handle missing API keys
        ok 6 - should handle missing API keys
          ---
          duration_ms: 0.871112
          type: 'test'
          ...
        1..6
    ok 7 - Configuration Edge Cases
      ---
      duration_ms: 3.153446
      type: 'suite'
      ...
# [grok] Request failed (attempt 1/3), retrying in 1000ms...
# [grok] Request failed (attempt 2/3), retrying in 2000ms...
# 2025-11-13 14:55:00 [[31merror[39m]: [LLMBridge] Query failed for provider "grok" {"service":"ai-orchestra","error":"{\\"provider\\":\\"grok\\",\\"message\\":\\"Request failed with status code 403\\",\\"code\\":\\"ERR_BAD_REQUEST\\",\\"timestamp\\":\\"2025-11-13T14:55:00.091Z\\",\\"status\\":403,\\"statusText\\":\\"Forbidden\\",\\"data\\":\\"Access denied\\"}"}
# 2025-11-13 14:55:00 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
    # Subtest: Query Edge Cases
        # Subtest: should reject query with empty prompt
        ok 1 - should reject query with empty prompt
          ---
          duration_ms: 3029.412829
          type: 'test'
          ...
# [grok] Request failed (attempt 1/3), retrying in 1000ms...
# [grok] Request failed (attempt 2/3), retrying in 2000ms...
# 2025-11-13 14:55:03 [[31merror[39m]: [LLMBridge] Query failed for provider "grok" {"service":"ai-orchestra","error":"{\\"provider\\":\\"grok\\",\\"message\\":\\"Request failed with status code 403\\",\\"code\\":\\"ERR_BAD_REQUEST\\",\\"timestamp\\":\\"2025-11-13T14:55:03.109Z\\",\\"status\\":403,\\"statusText\\":\\"Forbidden\\",\\"data\\":\\"Access denied\\"}"}
# 2025-11-13 14:55:03 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
        # Subtest: should reject query with null prompt
        ok 2 - should reject query with null prompt
          ---
          duration_ms: 3018.316343
          type: 'test'
          ...
# [grok] Request failed (attempt 1/3), retrying in 1000ms...
# [grok] Request failed (attempt 2/3), retrying in 2000ms...
# 2025-11-13 14:55:06 [[31merror[39m]: [LLMBridge] Query failed for provider "grok" {"service":"ai-orchestra","error":"{\\"provider\\":\\"grok\\",\\"message\\":\\"Request failed with status code 403\\",\\"code\\":\\"ERR_BAD_REQUEST\\",\\"timestamp\\":\\"2025-11-13T14:55:06.129Z\\",\\"status\\":403,\\"statusText\\":\\"Forbidden\\",\\"data\\":\\"Access denied\\"}"}
# 2025-11-13 14:55:06 [[32minfo[39m]: [LLMBridge] Grok connector initialized {"service":"ai-orchestra"}
# 2025-11-13 14:55:06 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:55:06 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:55:06 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
# 2025-11-13 14:55:06 [[33mwarn[39m]: [LLMBridge] No connectors initialized. Check your configuration. {"service":"ai-orchestra"}
        # Subtest: should reject query with undefined prompt
        ok 3 - should reject query with undefined prompt
          ---
          duration_ms: 3019.951327
          type: 'test'
          ...
        # Subtest: should reject query with invalid provider
        ok 4 - should reject query with invalid provider
          ---
          duration_ms: 1.717405
          type: 'test'
          ...
        1..4
    ok 8 - Query Edge Cases
      ---
      duration_ms: 9069.793962
      type: 'suite'
      ...
    # Subtest: Initialization Edge Cases
        # Subtest: should handle null config
        ok 1 - should handle null config
          ---
          duration_ms: 0.607772
          type: 'test'
          ...
        # Subtest: should handle undefined config
        ok 2 - should handle undefined config
          ---
          duration_ms: 0.374858
          type: 'test'
          ...
        # Subtest: should handle config without providers key
        ok 3 - should handle config without providers key
          ---
          duration_ms: 0.318516
          type: 'test'
          ...
        # Subtest: should set default values when config is empty
        ok 4 - should set default values when config is empty
          ---
          duration_ms: 0.283321
          type: 'test'
          ...
        1..4
    ok 9 - Initialization Edge Cases
      ---
      duration_ms: 1.797327
      type: 'suite'
      ...
    1..9
ok 5 - LLM Bridge Advanced Tests
  ---
  duration_ms: 9231.2542
  type: 'suite'
  ...
# Subtest: Server - Critical Functionality
    # Subtest: Health Check Endpoints
        # Subtest: should return health status with all service states
        ok 1 - should return health status with all service states
          ---
          duration_ms: 0.940396
          type: 'test'
          ...
        # Subtest: should return ok status when all services are healthy
        ok 2 - should return ok status when all services are healthy
          ---
          duration_ms: 0.161861
          type: 'test'
          ...
        # Subtest: should return degraded status when any service fails
        ok 3 - should return degraded status when any service fails
          ---
          duration_ms: 0.108417
          type: 'test'
          ...
        # Subtest: should handle disabled services correctly
        ok 4 - should handle disabled services correctly
          ---
          duration_ms: 0.099489
          type: 'test'
          ...
        # Subtest: should include version and environment information
        ok 5 - should include version and environment information
          ---
          duration_ms: 0.099908
          type: 'test'
          ...
        1..5
    ok 1 - Health Check Endpoints
      ---
      duration_ms: 2.324686
      type: 'suite'
      ...
    # Subtest: API Input Validation (P0)
        # Subtest: Valid Requests
            # Subtest: should accept valid basic query
            ok 1 - should accept valid basic query
              ---
              duration_ms: 0.16414
              type: 'test'
              ...
            # Subtest: should accept query with provider and model
            ok 2 - should accept query with provider and model
              ---
              duration_ms: 0.092032
              type: 'test'
              ...
            # Subtest: should accept query with temperature and maxTokens
            ok 3 - should accept query with temperature and maxTokens
              ---
              duration_ms: 0.1857
              type: 'test'
              ...
            # Subtest: should accept query with all options
            ok 4 - should accept query with all options
              ---
              duration_ms: 0.096129
              type: 'test'
              ...
            1..4
        ok 1 - Valid Requests
          ---
          duration_ms: 0.706863
          type: 'suite'
          ...
        # Subtest: Invalid Requests - Missing/Empty Prompt
            # Subtest: should reject request without prompt
            ok 1 - should reject request without prompt
              ---
              duration_ms: 0.129286
              type: 'test'
              ...
            # Subtest: should reject request with empty prompt
            ok 2 - should reject request with empty prompt
              ---
              duration_ms: 0.080484
              type: 'test'
              ...
            # Subtest: should reject request with null prompt
            ok 3 - should reject request with null prompt
              ---
              duration_ms: 0.107055
              type: 'test'
              ...
            # Subtest: should reject request with undefined prompt
            ok 4 - should reject request with undefined prompt
              ---
              duration_ms: 0.078437
              type: 'test'
              ...
            1..4
        ok 2 - Invalid Requests - Missing/Empty Prompt
          ---
          duration_ms: 0.540719
          type: 'suite'
          ...
        # Subtest: Invalid Requests - Temperature Validation
            # Subtest: should reject temperature > 2.0
            ok 1 - should reject temperature > 2.0
              ---
              duration_ms: 0.111546
              type: 'test'
              ...
            # Subtest: should reject negative temperature
            ok 2 - should reject negative temperature
              ---
              duration_ms: 0.089393
              type: 'test'
              ...
            1..2
        ok 3 - Invalid Requests - Temperature Validation
          ---
          duration_ms: 0.300189
          type: 'suite'
          ...
        # Subtest: Invalid Requests - MaxTokens Validation
            # Subtest: should reject negative maxTokens
            ok 1 - should reject negative maxTokens
              ---
              duration_ms: 0.126041
              type: 'test'
              ...
            # Subtest: should reject non-numeric maxTokens
            ok 2 - should reject non-numeric maxTokens
              ---
              duration_ms: 0.080846
              type: 'test'
              ...
            1..2
        ok 4 - Invalid Requests - MaxTokens Validation
          ---
          duration_ms: 0.302259
          type: 'suite'
          ...
        # Subtest: Security - Injection Attempts
            # Subtest: should handle SQL injection attempts safely
            ok 1 - should handle SQL injection attempts safely
              ---
              duration_ms: 0.126394
              type: 'test'
              ...
            # Subtest: should handle XSS attempts safely
            ok 2 - should handle XSS attempts safely
              ---
              duration_ms: 0.083115
              type: 'test'
              ...
            1..2
        ok 5 - Security - Injection Attempts
          ---
          duration_ms: 0.304456
          type: 'suite'
          ...
        # Subtest: Edge Cases
            # Subtest: should accept minimum valid prompt
            ok 1 - should accept minimum valid prompt
              ---
              duration_ms: 2.117922
              type: 'test'
              ...
            # Subtest: should handle long prompts appropriately
            ok 2 - should handle long prompts appropriately
              ---
              duration_ms: 0.153195
              type: 'test'
              ...
            # Subtest: should handle zero temperature
            ok 3 - should handle zero temperature
              ---
              duration_ms: 0.116531
              type: 'test'
              ...
            # Subtest: should handle max temperature
            ok 4 - should handle max temperature
              ---
              duration_ms: 0.11914
              type: 'test'
              ...
            # Subtest: should handle unicode characters
            ok 5 - should handle unicode characters
              ---
              duration_ms: 0.133705
              type: 'test'
              ...
            # Subtest: should handle special characters
            ok 6 - should handle special characters
              ---
              duration_ms: 0.117709
              type: 'test'
              ...
            # Subtest: should handle multiline prompts
            ok 7 - should handle multiline prompts
              ---
              duration_ms: 0.131956
              type: 'test'
              ...
            1..7
        ok 6 - Edge Cases
          ---
          duration_ms: 3.187962
          type: 'suite'
          ...
        1..6
    ok 2 - API Input Validation (P0)
      ---
      duration_ms: 5.646709
      type: 'suite'
      ...
    # Subtest: Error Handling Middleware (P0)
        # Subtest: should handle provider errors gracefully
        ok 1 - should handle provider errors gracefully
          ---
          duration_ms: 0.179745
          type: 'test'
          ...
        # Subtest: should handle rate limit errors
        ok 2 - should handle rate limit errors
          ---
          duration_ms: 0.117862
          type: 'test'
          ...
        # Subtest: should handle timeout errors
        ok 3 - should handle timeout errors
          ---
          duration_ms: 0.142309
          type: 'test'
          ...
        # Subtest: should handle generic server errors
        ok 4 - should handle generic server errors
          ---
          duration_ms: 0.104461
          type: 'test'
          ...
        # Subtest: should handle validation errors
        ok 5 - should handle validation errors
          ---
          duration_ms: 0.087823
          type: 'test'
          ...
        # Subtest: should not expose sensitive information in errors
        ok 6 - should not expose sensitive information in errors
          ---
          duration_ms: 0.086506
          type: 'test'
          ...
        # Subtest: should log errors properly for debugging
        ok 7 - should log errors properly for debugging
          ---
          duration_ms: 0.07832
          type: 'test'
          ...
        1..7
    ok 3 - Error Handling Middleware (P0)
      ---
      duration_ms: 1.056093
      type: 'suite'
      ...
    # Subtest: Rate Limiting (Bug \#3 Fix - HIGH Priority)
        # Subtest: should enable rate limiting when configured
        ok 1 - should enable rate limiting when configured
          ---
          duration_ms: 0.162364
          type: 'test'
          ...
        # Subtest: should use correct configuration property name
        ok 2 - should use correct configuration property name
          ---
          duration_ms: 0.096244
          type: 'test'
          ...
        # Subtest: should have default rate limit values
        ok 3 - should have default rate limit values
          ---
          duration_ms: 0.435698
          type: 'test'
          ...
        # Subtest: should return proper error message when rate limited
        ok 4 - should return proper error message when rate limited
          ---
          duration_ms: 0.154051
          type: 'test'
          ...
        1..4
    ok 4 - Rate Limiting (Bug \#3 Fix - HIGH Priority)
      ---
      duration_ms: 1.057279
      type: 'suite'
      ...
    # Subtest: 404 Handler
        # Subtest: should return 404 for unknown routes
        ok 1 - should return 404 for unknown routes
          ---
          duration_ms: 0.166265
          type: 'test'
          ...
        # Subtest: should return JSON error format
        ok 2 - should return JSON error format
          ---
          duration_ms: 0.134858
          type: 'test'
          ...
        1..2
    ok 5 - 404 Handler
      ---
      duration_ms: 0.413244
      type: 'suite'
      ...
    # Subtest: Graceful Shutdown
        # Subtest: should handle SIGTERM gracefully
        ok 1 - should handle SIGTERM gracefully
          ---
          duration_ms: 0.451046
          type: 'test'
          ...
        # Subtest: should handle SIGINT gracefully
        ok 2 - should handle SIGINT gracefully
          ---
          duration_ms: 0.111589
          type: 'test'
          ...
        # Subtest: should handle uncaught exceptions
        ok 3 - should handle uncaught exceptions
          ---
          duration_ms: 0.087064
          type: 'test'
          ...
        # Subtest: should handle unhandled promise rejections
        ok 4 - should handle unhandled promise rejections
          ---
          duration_ms: 0.130141
          type: 'test'
          ...
        1..4
    ok 6 - Graceful Shutdown
      ---
      duration_ms: 0.960149
      type: 'suite'
      ...
    # Subtest: Metrics Endpoint
        # Subtest: should expose Prometheus metrics
        ok 1 - should expose Prometheus metrics
          ---
          duration_ms: 0.133054
          type: 'test'
          ...
        # Subtest: should track HTTP request metrics
        ok 2 - should track HTTP request metrics
          ---
          duration_ms: 0.106998
          type: 'test'
          ...
        # Subtest: should track LLM query metrics
        ok 3 - should track LLM query metrics
          ---
          duration_ms: 0.095602
          type: 'test'
          ...
        # Subtest: should track WebSocket connections
        ok 4 - should track WebSocket connections
          ---
          duration_ms: 0.100435
          type: 'test'
          ...
        1..4
    ok 7 - Metrics Endpoint
      ---
      duration_ms: 0.592654
      type: 'suite'
      ...
    # Subtest: Middleware Stack
        # Subtest: should apply helmet security headers when enabled
        ok 1 - should apply helmet security headers when enabled
          ---
          duration_ms: 0.21974
          type: 'test'
          ...
        # Subtest: should apply CORS when enabled
        ok 2 - should apply CORS when enabled
          ---
          duration_ms: 0.125876
          type: 'test'
          ...
        # Subtest: should parse JSON request bodies
        ok 3 - should parse JSON request bodies
          ---
          duration_ms: 0.093215
          type: 'test'
          ...
        # Subtest: should parse URL-encoded bodies
        ok 4 - should parse URL-encoded bodies
          ---
          duration_ms: 0.091678
          type: 'test'
          ...
        # Subtest: should log all HTTP requests
        ok 5 - should log all HTTP requests
          ---
          duration_ms: 0.084271
          type: 'test'
          ...
        1..5
    ok 8 - Middleware Stack
      ---
      duration_ms: 0.83968
      type: 'suite'
      ...
    1..8
ok 6 - Server - Critical Functionality
  ---
  duration_ms: 13.788771
  type: 'suite'
  ...
# Subtest: Server - API Endpoints
    # Subtest: POST /api/query
        # Subtest: should return 400 when prompt is missing
        ok 1 - should return 400 when prompt is missing
          ---
          duration_ms: 0.20907
          type: 'test'
          ...
        # Subtest: should successfully process valid query
        ok 2 - should successfully process valid query
          ---
          duration_ms: 0.115844
          type: 'test'
          ...
        # Subtest: should record LLM query metrics
        ok 3 - should record LLM query metrics
          ---
          duration_ms: 0.086526
          type: 'test'
          ...
        # Subtest: should log query details
        ok 4 - should log query details
          ---
          duration_ms: 0.084969
          type: 'test'
          ...
        # Subtest: should handle errors with proper status codes
        ok 5 - should handle errors with proper status codes
          ---
          duration_ms: 0.09232
          type: 'test'
          ...
        1..5
    ok 1 - POST /api/query
      ---
      duration_ms: 0.811289
      type: 'suite'
      ...
    # Subtest: POST /api/stream
        # Subtest: should return 400 when prompt is missing
        ok 1 - should return 400 when prompt is missing
          ---
          duration_ms: 0.169662
          type: 'test'
          ...
        # Subtest: should set proper headers for streaming
        ok 2 - should set proper headers for streaming
          ---
          duration_ms: 0.133967
          type: 'test'
          ...
        # Subtest: should stream chunks in SSE format
        ok 3 - should stream chunks in SSE format
          ---
          duration_ms: 0.131016
          type: 'test'
          ...
        # Subtest: should send [DONE] at end of stream
        ok 4 - should send [DONE] at end of stream
          ---
          duration_ms: 0.105004
          type: 'test'
          ...
        1..4
    ok 2 - POST /api/stream
      ---
      duration_ms: 0.742484
      type: 'suite'
      ...
    # Subtest: GET /api/status
        # Subtest: should return application status
        ok 1 - should return application status
          ---
          duration_ms: 0.142016
          type: 'test'
          ...
        # Subtest: should return LLM stats
        ok 2 - should return LLM stats
          ---
          duration_ms: 0.224441
          type: 'test'
          ...
        # Subtest: should return GitHub status
        ok 3 - should return GitHub status
          ---
          duration_ms: 0.124161
          type: 'test'
          ...
        1..3
    ok 3 - GET /api/status
      ---
      duration_ms: 0.630514
      type: 'suite'
      ...
    # Subtest: GET /api/providers
        # Subtest: should return list of available providers
        ok 1 - should return list of available providers
          ---
          duration_ms: 0.144719
          type: 'test'
          ...
        1..1
    ok 4 - GET /api/providers
      ---
      duration_ms: 0.225396
      type: 'suite'
      ...
    # Subtest: GET /api/models
        # Subtest: should return available models
        ok 1 - should return available models
          ---
          duration_ms: 0.133643
          type: 'test'
          ...
        # Subtest: should handle errors gracefully
        ok 2 - should handle errors gracefully
          ---
          duration_ms: 0.302535
          type: 'test'
          ...
        1..2
    ok 5 - GET /api/models
      ---
      duration_ms: 0.585198
      type: 'suite'
      ...
    1..5
ok 7 - Server - API Endpoints
  ---
  duration_ms: 3.321777
  type: 'suite'
  ...
1..7
# tests 272
# suites 60
# pass 272
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 10138.774215
----------------------|---------|----------|---------|---------|------------------------------------
File                  | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                  
----------------------|---------|----------|---------|---------|------------------------------------
All files             |   61.36 |    59.03 |   60.34 |   61.36 |                                    
 core                 |   83.11 |    60.74 |   84.37 |   83.11 |                                    
  base_connector.js   |     100 |    96.42 |     100 |     100 | 13                                 
  config_manager.js   |   78.17 |    24.56 |   72.72 |   78.17 | ...304-305,308-309,312-313,325-338 
  llm_bridge.js       |    78.4 |    82.97 |   81.81 |    78.4 | ...107-125,134-155,223-227,244-246 
  logger.js           |     100 |    66.66 |     100 |     100 | 23                                 
 core/connectors      |      40 |    51.61 |   30.76 |      40 |                                    
  grok_connector.js   |   57.37 |       50 |   57.14 |   57.37 | ...162-176,186,195,210-214,238-250 
  ollama_connector.js |   32.38 |       50 |   27.27 |   32.38 | ...251-260,268-277,286-298,307-317 
  openai_connector.js |   31.22 |    66.66 |    12.5 |   31.22 | ...142-149,156-170,179-190,198-220 
----------------------|---------|----------|---------|---------|------------------------------------
